class Gallery{constructor(t){this.galleryElem=t,this.galleryItems=[...t.querySelectorAll(".gallery__link")],this.maxLength=this.galleryItems.length,this.showCount=3,this.arrCoords=[],this.scale=1,this.showGallery=this.showGallery.bind(this),this.distributeElementsToArrs=this.distributeElementsToArrs.bind(this),this.slidePrevImage=this.slidePrevImage.bind(this),this.slideNextImage=this.slideNextImage.bind(this),this.setModalStyles=this.setModalStyles.bind(this),this.closeGallery=this.closeGallery.bind(this),this.createModal(),this.events()}createModal(){this.modalGallery=document.createElement("div"),this.modalGallery.className="gallery-modal modal",this.modalGallery.innerHTML=`\n\t\t\t<div class="modal__controls controls-modal">\n\t\t\t\t<button class="controls-modal__close">\n\t\t\t\t</button>\n\t\t\t\t<div class="controls-modal__nav">\n\t\t\t\t\t<button class="controls-modal__btn controls-modal__btn-next"></button>\n\t\t\t\t\t<div class="controls-modal__counter">\n\t\t\t\t\t\t<span id="mc-current">1</span>/<span id="mc-length">20</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class="controls-modal__btn controls-modal__btn-prev"></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="modal__list">\n\t\t\t\t${this.galleryItems.map((t=>`\n\t\t\t\t\t\t<img src="${t.getAttribute("data-src")}" alt="${t.getAttribute("data-alt")}" class="modal__img">\n\t\t\t\t\t`)).join("")}\n\t\t\t</div>\n\t\t`,document.body.appendChild(this.modalGallery),this.modalImages=this.modalGallery.querySelectorAll(".modal__img"),this.modalControls=this.modalGallery.querySelector(".modal__controls"),this.modalControlsButtons=this.modalControls.querySelectorAll(".controls-modal__btn"),this.modalContolsPrev=this.modalControls.querySelector(".controls-modal__btn-prev"),this.modalContolsNext=this.modalControls.querySelector(".controls-modal__btn-next"),this.modalControlsClose=this.modalControls.querySelector(".controls-modal__close")}events(){this.galleryElem.addEventListener("click",this.showGallery),this.modalControlsClose.addEventListener("click",this.closeGallery);let t=debounce(this.slideNextImage,500),e=debounce(this.slidePrevImage,500);this.modalContolsPrev.addEventListener("click",e),this.modalContolsNext.addEventListener("click",t);let s=throttle(this.setModalStyles,300);window.addEventListener("resize",s)}showGallery(t){t.preventDefault(),this.galleryElem.removeEventListener("click",this.showGallery),window.innerWidth<992?this.showCount=1:this.showCount=3;let e=t.target.closest("a");e&&(this.setSizesImages(),this.setPositionsImages(),this.currentIndex=this.galleryItems.indexOf(e),this.modalGallery.classList.add("open"),this.modalControls.classList.add("open"),this.mcCurrent=this.modalControls.querySelector("#mc-current"),this.mcLength=this.modalControls.querySelector("#mc-length"),this.mcCurrent.innerHTML=this.currentIndex+1,this.mcLength.innerHTML=this.maxLength,fadeIn(this.modalGallery,this.distributeElementsToArrs),fadeIn(this.modalControls))}setSizesImages(){this.galleryItems.forEach(((t,e)=>{let s=t.getBoundingClientRect();this.modalImages[e].style.width=`${s.width}px`,this.modalImages[e].style.height=`${s.height}px`}))}setPositionsImages(){this.galleryItems.forEach(((t,e)=>{let s=t.getBoundingClientRect();this.setPositionStyles(this.modalImages[e],s.x,s.y),this.arrCoords.push([s.x,s.y])}))}setPositionStyles(t,e,s){t.style.transform=`translate3d(${e}px,${s}px,0)`}distributeElementsToArrs(){this.arrHiddenImagesTop=[],this.arrVisibleImagesTop=[],this.arrCurrentImage=[],this.arrVisibleImagesBottom=[],this.arrHiddenImagesBottom=[],this.currentIndex<=0?this.disabledSlideButton(this.modalContolsPrev):this.currentIndex>=this.maxLength-1?this.disabledSlideButton(this.modalContolsNext):this.modalControlsButtons.forEach((t=>{this.enabledSlideButton(t)})),this.modalImages.forEach(((t,e)=>{e+this.showCount<this.currentIndex?this.arrHiddenImagesTop.unshift(t):e<this.currentIndex?this.arrVisibleImagesTop.unshift(t):e===this.currentIndex?this.arrCurrentImage.push(t):e<=this.currentIndex+this.showCount?this.arrVisibleImagesBottom.push(t):this.arrHiddenImagesBottom.push(t)})),this.setModalStyles()}setModalStyles(){const t=window.innerWidth,e=window.innerHeight,s=this.modalImages[0].offsetWidth,l=this.modalImages[0].offsetHeight;this.scale=t<650?.5:1,this.modalGallery.classList.contains("open")&&(this.arrHiddenImagesTop.forEach((s=>{this.setModalImagesStyle(s,{top:-1.5*e,left:.25*t,opacity:.1,zIndex:1,scale:.3})})),this.setModalImagesStyle(this.arrVisibleImagesTop[0],{top:.01*e,left:.75*t-s/2,opacity:.5,zIndex:1,scale:this.scale-.2}),this.setModalImagesStyle(this.arrVisibleImagesTop[1],{top:.01*e,left:.48*t-s/2,opacity:.5,zIndex:1,scale:this.scale-.4}),this.setModalImagesStyle(this.arrVisibleImagesTop[2],{top:.01*e,left:.25*t-s/2,opacity:.5,zIndex:1,scale:this.scale-.5}),this.setModalImagesStyle(this.arrCurrentImage[0],{top:e/2-l/2,left:t/2-s/2,opacity:1,zIndex:100,scale:this.scale+.5}),this.setModalImagesStyle(this.arrVisibleImagesBottom[0],{top:.99*e-l,left:.25*t-s/2,opacity:.5,zIndex:1,scale:this.scale-.2}),this.setModalImagesStyle(this.arrVisibleImagesBottom[1],{top:.99*e-l,left:.52*t-s/2,opacity:.5,zIndex:1,scale:this.scale-.4}),this.setModalImagesStyle(this.arrVisibleImagesBottom[2],{top:.99*e-l,left:.75*t-s/2,opacity:.5,zIndex:1,scale:this.scale-.5}),this.arrHiddenImagesBottom.forEach(((s,l)=>{this.setModalImagesStyle(s,{top:1.5*e,left:.75*t,opacity:.1,zIndex:1,scale:.3})})))}setModalImagesStyle(t,{top:e,left:s,opacity:l,scale:i,zIndex:o}){t&&(t.style.transition="all .7s",t.style.opacity=`${l}`,t.style.zIndex=`${o}`,t.style.transform=`translate3d(${s}px,${e}px,0) scale(${i})`)}slidePrevImage(){this.currentIndex<=0?this.currentIndex=0:this.currentIndex--,this.mcCurrent.innerHTML=this.currentIndex+1,this.distributeElementsToArrs()}slideNextImage(){this.currentIndex>=this.maxLength-1?this.currentIndex=this.maxLength-1:this.currentIndex++,this.mcCurrent.innerHTML=this.currentIndex+1,this.distributeElementsToArrs()}disabledSlideButton(t){t.disabled=!0,t.style.opacity=.2,t.style.pointerEvents="none"}enabledSlideButton(t){t.disabled=!1,t.style.opacity=1,t.style.pointerEvents=""}closeGallery(){this.modalImages.forEach(((t,e)=>{this.setPositionStyles(t,this.arrCoords[e][0],this.arrCoords[e][1])})),this.modalControlsButtons.forEach((t=>{this.enabledSlideButton(t)})),fadeOut(this.modalGallery,(()=>{this.modalGallery.classList.remove("open"),this.modalControls.classList.remove("open"),this.arrCoords=[],this.galleryElem.addEventListener("click",this.showGallery)}))}}function fadeIn(t,e){!function s(){let l=Number(t.style.opacity);if(t.style.visibility="visible",l<1)return l+=.1,t.style.opacity=l,void window.requestAnimationFrame(s);e&&e()}()}function debounce(t,e){let s=!1;return function(...l){s||(t.apply(this,l),s=!0,setTimeout((()=>s=!1),e))}}function throttle(t,e){let s,l,i=!1;return function(...o){if(i)return s=o,void(l=this);t.apply(this,o),i=!0,setTimeout((()=>{i=!1,s&&(t.apply(l,s),s=null,l=null)}),e)}}function fadeOut(t,e){!function s(){let l=Number(t.style.opacity);if(t.style.visibility="hidden",l>0)return l-=.02,t.style.opacity=l,void window.requestAnimationFrame(s);e&&e()}()}let gallery=new Gallery(document.querySelector(".gallery"));